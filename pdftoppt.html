<!DOCTYPE html>
<html lang="en" xml:lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <title>PDF to PowerPoint Converter | Fast, Accessible Online Tool | ConvertWise</title>
    <meta name="description" content="Convert PDF to PowerPoint presentations with full accessibility support. Free online tool with screen reader compatibility.">
    
    <!-- No meta refresh for accessibility -->
    
    <!-- Preload critical resources -->
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" as="style" crossorigin="anonymous">
    
    <!-- Inline critical CSS with accessibility focus -->
    <style>
        /* ===== ACCESSIBILITY-FOCUSED CRITICAL CSS ===== */
        :root {
            --primary: #2563eb;    /* 4.68:1 contrast on white */
            --primary-dark: #1d4ed8;
            --secondary: #059669;  /* 4.58:1 contrast on white */
            --light: #f8fafc;
            --dark: #1e293b;       /* 15.9:1 contrast on white */
            --gray: #64748b;
            --white: #ffffff;
            --radius: 8px;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        /* High contrast focus styles */
        :focus {
            outline: 3px solid var(--primary);
            outline-offset: 2px;
        }

        :focus:not(:focus-visible) {
            outline: none;
        }

        :focus-visible {
            outline: 3px solid var(--primary);
            outline-offset: 2px;
        }

        /* Skip link - hidden until focused */
        .skip-link {
            position: absolute;
            top: -40px;
            left: 0;
            background: var(--primary);
            color: var(--white);
            padding: 8px;
            z-index: 1001;
            text-decoration: none;
            border-radius: 0 0 var(--radius) 0;
        }

        .skip-link:focus {
            top: 0;
        }

        /* Base styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            line-height: 1.5;
            color: var(--dark);
            background: var(--white);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Header with proper landmarks */
        .header {
            background: var(--white);
            box-shadow: var(--shadow);
            padding: 1rem;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            text-decoration: none;
            color: var(--dark);
            font-weight: 700;
            font-size: 1.25rem;
        }

        .logo:focus {
            outline: 3px solid var(--primary);
            outline-offset: 2px;
            border-radius: var(--radius);
        }

        .logo-icon {
            width: 32px;
            height: 32px;
            background: var(--primary);
            color: var(--white);
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.125rem;
        }

        /* Navigation with proper ARIA */
        .main-nav {
            display: flex;
            gap: 1rem;
        }

        .nav-link {
            padding: 0.5rem 1rem;
            text-decoration: none;
            color: var(--dark);
            border-radius: var(--radius);
            transition: background-color 0.2s;
        }

        .nav-link:hover,
        .nav-link:focus {
            background: var(--light);
        }

        .nav-link[aria-current="page"] {
            background: var(--primary);
            color: var(--white);
        }

        /* Mobile menu button */
        .menu-button {
            display: none;
            background: none;
            border: none;
            color: var(--dark);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: var(--radius);
        }

        .menu-button:focus {
            outline: 3px solid var(--primary);
            outline-offset: 2px;
        }

        /* Main content with landmarks */
        main {
            flex: 1;
        }

        /* Hero section */
        .hero {
            padding: 2rem 1rem;
            text-align: center;
            background: linear-gradient(135deg, var(--light) 0%, var(--white) 100%);
        }

        .hero h1 {
            font-size: 2rem;
            margin-bottom: 1rem;
            color: var(--dark);
        }

        .hero p {
            color: var(--gray);
            max-width: 600px;
            margin: 0 auto 1.5rem;
        }

        /* Upload area with proper ARIA */
        .upload-area {
            max-width: 600px;
            margin: 0 auto;
            border: 2px dashed #cbd5e1;
            border-radius: var(--radius);
            padding: 2rem;
            text-align: center;
            background: var(--white);
        }

        .upload-area:focus-within {
            border-color: var(--primary);
            outline: 3px solid var(--primary);
            outline-offset: 2px;
        }

        .upload-icon {
            font-size: 3rem;
            color: var(--primary);
            margin-bottom: 1rem;
        }

        /* Buttons with accessible names */
        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: var(--radius);
            font-weight: 600;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn:focus {
            outline: 3px solid var(--primary);
            outline-offset: 2px;
        }

        .btn-primary {
            background: var(--primary);
            color: var(--white);
        }

        .btn-primary:hover,
        .btn-primary:focus {
            background: var(--primary-dark);
        }

        .btn-secondary {
            background: var(--light);
            color: var(--dark);
            border-color: #cbd5e1;
        }

        .btn-secondary:hover,
        .btn-secondary:focus {
            background: #e2e8f0;
        }

        /* Form controls with labels */
        .form-group {
            margin-bottom: 1rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--dark);
        }

        .form-control {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #cbd5e1;
            border-radius: var(--radius);
            font-size: 1rem;
            background: var(--white);
            color: var(--dark);
        }

        .form-control:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        /* Checkbox and radio accessibility */
        .checkbox,
        .radio {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .checkbox input[type="checkbox"],
        .radio input[type="radio"] {
            width: 1.25rem;
            height: 1.25rem;
        }

        /* Progress bar with ARIA */
        .progress {
            height: 8px;
            background: #e2e8f0;
            border-radius: 4px;
            overflow: hidden;
            margin: 1rem 0;
        }

        .progress-bar {
            height: 100%;
            background: var(--primary);
            transition: width 0.3s;
        }

        /* Live regions for screen readers */
        [aria-live="polite"],
        [aria-live="assertive"] {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        /* Alert styles */
        .alert {
            padding: 1rem;
            border-radius: var(--radius);
            margin-bottom: 1rem;
            border: 2px solid transparent;
        }

        .alert-success {
            background: #d1fae5;
            border-color: #a7f3d0;
            color: #065f46;
        }

        .alert-error {
            background: #fee2e2;
            border-color: #fecaca;
            color: #991b1b;
        }

        /* Footer with landmarks */
        .footer {
            margin-top: auto;
            background: var(--dark);
            color: var(--white);
            padding: 2rem 1rem;
        }

        .footer a {
            color: #cbd5e1;
        }

        .footer a:hover,
        .footer a:focus {
            color: var(--white);
            text-decoration: underline;
        }

        /* Screen reader only */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        /* Reduced motion support */
        @media (prefers-reduced-motion: reduce) {
            *,
            *::before,
            *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
                scroll-behavior: auto !important;
            }
        }

        /* High contrast mode support */
        @media (prefers-contrast: high) {
            :root {
                --primary: #0044cc;
                --primary-dark: #003399;
                --dark: #000000;
            }
        }

        /* Dark mode support */
        @media (prefers-color-scheme: dark) {
            :root {
                --light: #1e293b;
                --dark: #f1f5f9;
                --white: #0f172a;
                --gray: #94a3b8;
            }
            
            body {
                background: var(--white);
                color: var(--dark);
            }
            
            .header {
                background: var(--white);
            }
            
            .upload-area {
                background: #1e293b;
                border-color: #475569;
            }
            
            .btn-secondary {
                background: #334155;
                border-color: #475569;
                color: var(--dark);
            }
        }
    </style>

    <!-- Deferred non-critical CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" media="print" onload="this.media='all'" crossorigin="anonymous">
    
    <noscript>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    </noscript>
</head>
<body>
    <!-- Skip to main content link -->
    <a href="#main-content" class="skip-link">
        Skip to main content
    </a>

    <!-- ARIA Live Region for announcements -->
    <div id="live-region" aria-live="polite" aria-atomic="true" class="sr-only"></div>

    <!-- Header with banner role -->
    <header class="header" role="banner">
        <div class="container">
            <div class="header-content">
                <!-- Logo with proper heading -->
                <a href="/" class="logo">
                    <span class="logo-icon" aria-hidden="true">
                        <i class="fas fa-file-powerpoint"></i>
                    </span>
                    <span>ConvertWise</span>
                    <span class="sr-only"> - PDF to PowerPoint Converter</span>
                </a>

                <!-- Navigation with nav role -->
                <nav class="main-nav" role="navigation" aria-label="Main navigation">
                    <button class="menu-button" aria-label="Toggle menu" aria-expanded="false" aria-controls="nav-menu">
                        <i class="fas fa-bars" aria-hidden="true"></i>
                    </button>
                    
                    <div id="nav-menu">
                        <a href="/" class="nav-link" aria-current="page">Home</a>
                        <a href="/tools" class="nav-link">All Tools</a>
                        <a href="/about" class="nav-link">About</a>
                        <a href="/contact" class="nav-link">Contact</a>
                    </div>
                </nav>
            </div>
        </div>
    </header>

    <!-- Main content with main role -->
    <main id="main-content" role="main" class="main-content">
        <div class="container">
            <!-- Hero section -->
            <section class="hero" aria-labelledby="hero-heading">
                <h1 id="hero-heading">Convert PDF to PowerPoint Online</h1>
                <p>Free, accessible tool to convert PDF files to editable PowerPoint presentations with full screen reader support.</p>
                
                <!-- Upload section -->
                <div class="upload-area" role="region" aria-labelledby="upload-heading">
                    <div class="upload-icon" aria-hidden="true">
                        <i class="fas fa-cloud-upload-alt"></i>
                    </div>
                    <h2 id="upload-heading" class="sr-only">Upload PDF File</h2>
                    
                    <p id="upload-instructions">Drag and drop your PDF file here, or use the button below to browse</p>
                    
                    <div class="form-group">
                        <label for="fileInput" class="sr-only">Choose PDF file</label>
                        <input type="file" 
                               id="fileInput" 
                               accept=".pdf"
                               class="sr-only"
                               aria-describedby="file-input-help">
                        <button class="btn btn-primary" id="uploadBtn" aria-controls="fileInput">
                            <i class="fas fa-upload" aria-hidden="true"></i>
                            Choose PDF File
                        </button>
                        <div id="file-input-help" class="sr-only">
                            Supported formats: PDF. Maximum file size: 100MB
                        </div>
                    </div>
                    
                    <div role="alert" aria-live="polite" id="upload-status"></div>
                </div>
            </section>

            <!-- File info section -->
            <section class="file-section" role="region" aria-labelledby="file-heading" hidden>
                <h2 id="file-heading" class="sr-only">File Information</h2>
                
                <div class="file-info" role="alert" aria-live="polite">
                    <!-- File info will be inserted here -->
                </div>

                <!-- Options form -->
                <form id="conversion-form" class="options-form" role="form" aria-labelledby="options-heading">
                    <h3 id="options-heading">Conversion Settings</h3>
                    
                    <div class="form-group">
                        <label for="outputFormat" class="form-label">
                            <i class="fas fa-file-export" aria-hidden="true"></i>
                            Output Format
                        </label>
                        <select id="outputFormat" class="form-control" aria-describedby="format-help">
                            <option value="pptx">PowerPoint Presentation (.pptx)</option>
                            <option value="ppt">PowerPoint 97-2003 (.ppt)</option>
                        </select>
                        <div id="format-help" class="sr-only">
                            Choose between modern PPTX format or legacy PPT format
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="quality" class="form-label">
                            <i class="fas fa-image" aria-hidden="true"></i>
                            Image Quality
                        </label>
                        <select id="quality" class="form-control">
                            <option value="high">High Quality</option>
                            <option value="medium" selected>Medium (Recommended)</option>
                            <option value="low">Smaller File Size</option>
                        </select>
                    </div>

                    <fieldset>
                        <legend>Additional Options</legend>
                        
                        <div class="checkbox">
                            <input type="checkbox" id="preserveLayout" checked aria-describedby="layout-help">
                            <label for="preserveLayout">Preserve original layout</label>
                            <div id="layout-help" class="sr-only">
                                Maintain the exact layout of your PDF in the PowerPoint
                            </div>
                        </div>

                        <div class="checkbox">
                            <input type="checkbox" id="extractImages" checked>
                            <label for="extractImages">Extract images from PDF</label>
                        </div>

                        <div class="checkbox">
                            <input type="checkbox" id="detectText" checked>
                            <label for="detectText">Detect text and tables</label>
                        </div>
                    </fieldset>
                </form>

                <!-- Action buttons -->
                <div class="action-buttons" role="toolbar" aria-label="Conversion actions">
                    <button class="btn btn-secondary" id="clearBtn" aria-label="Clear all files">
                        <i class="fas fa-trash" aria-hidden="true"></i>
                        Clear
                    </button>
                    <button class="btn btn-primary" id="convertBtn" aria-label="Convert to PowerPoint">
                        <i class="fas fa-file-powerpoint" aria-hidden="true"></i>
                        Convert to PowerPoint
                    </button>
                </div>
            </section>

            <!-- Progress section -->
            <section class="progress-section" role="region" aria-labelledby="progress-heading" hidden>
                <h3 id="progress-heading" class="sr-only">Conversion Progress</h3>
                
                <div class="progress-container">
                    <div class="progress" role="progressbar" 
                         aria-valuemin="0" 
                         aria-valuemax="100" 
                         aria-valuenow="0"
                         aria-label="Conversion progress">
                        <div class="progress-bar" style="width: 0%"></div>
                    </div>
                    
                    <div class="progress-info" aria-live="polite">
                        <span id="progress-text">Starting conversion...</span>
                        <span id="progress-percent">0%</span>
                    </div>
                </div>
            </section>

            <!-- Result section -->
            <section class="result-section" role="region" aria-labelledby="result-heading" hidden>
                <h3 id="result-heading" class="sr-only">Conversion Results</h3>
                
                <div class="result-content" role="alert" aria-live="polite">
                    <div class="result-icon" aria-hidden="true">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    
                    <h4>Conversion Successful!</h4>
                    <p>Your PowerPoint file is ready to download.</p>
                    
                    <dl class="result-stats">
                        <dt>File Name:</dt>
                        <dd id="result-filename">presentation.pptx</dd>
                        
                        <dt>File Size:</dt>
                        <dd id="result-size">2.4 MB</dd>
                        
                        <dt>Pages Converted:</dt>
                        <dd id="result-pages">15</dd>
                        
                        <dt>Processing Time:</dt>
                        <dd id="result-time">2.3 seconds</dd>
                    </dl>

                    <div class="result-actions" role="toolbar" aria-label="Download actions">
                        <button class="btn btn-primary" id="downloadBtn" aria-label="Download PowerPoint file">
                            <i class="fas fa-download" aria-hidden="true"></i>
                            Download PowerPoint
                        </button>
                        
                        <button class="btn btn-secondary" id="newConversionBtn" aria-label="Start new conversion">
                            <i class="fas fa-redo" aria-hidden="true"></i>
                            Convert Another File
                        </button>
                    </div>
                </div>
            </section>

            <!-- Features section -->
            <section class="features" role="region" aria-labelledby="features-heading">
                <h2 id="features-heading">Accessibility Features</h2>
                
                <div class="features-grid" role="list">
                    <div class="feature-card" role="listitem">
                        <div class="feature-icon" aria-hidden="true">
                            <i class="fas fa-universal-access"></i>
                        </div>
                        <h3>Screen Reader Compatible</h3>
                        <p>Full compatibility with JAWS, NVDA, VoiceOver, and TalkBack screen readers.</p>
                    </div>
                    
                    <div class="feature-card" role="listitem">
                        <div class="feature-icon" aria-hidden="true">
                            <i class="fas fa-keyboard"></i>
                        </div>
                        <h3>Keyboard Navigation</h3>
                        <p>Complete keyboard support with logical tab order and shortcut keys.</p>
                    </div>
                    
                    <div class="feature-card" role="listitem">
                        <div class="feature-icon" aria-hidden="true">
                            <i class="fas fa-eye"></i>
                        </div>
                        <h3>High Contrast</h3>
                        <p>WCAG AA compliant color contrast ratios for all text and interactive elements.</p>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- Footer with contentinfo role -->
    <footer class="footer" role="contentinfo">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>ConvertWise</h3>
                    <p>Accessible file conversion tools for everyone.</p>
                </div>
                
                <div class="footer-section">
                    <h4>Quick Links</h4>
                    <ul role="list">
                        <li><a href="/accessibility">Accessibility Statement</a></li>
                        <li><a href="/privacy">Privacy Policy</a></li>
                        <li><a href="/terms">Terms of Service</a></li>
                        <li><a href="/contact">Contact Us</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h4>Accessibility Help</h4>
                    <ul role="list">
                        <li><a href="/keyboard-shortcuts">Keyboard Shortcuts</a></li>
                        <li><a href="/screen-reader-guide">Screen Reader Guide</a></li>
                        <li><a href="/report-accessibility-issue">Report Issue</a></li>
                    </ul>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2024 ConvertWise. All rights reserved.</p>
                <p>Designed with accessibility in mind.</p>
            </div>
        </div>
    </footer>

    <!-- JavaScript with accessibility enhancements -->
    <script>
        // Wait for DOM to be fully loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize accessibility features
            initAccessibility();
            
            // Initialize application
            initApp();
            
            // Announce page loaded to screen readers
            announceToScreenReader('PDF to PowerPoint converter page loaded');
        });

        // Initialize accessibility features
        function initAccessibility() {
            // Add skip link target
            const mainContent = document.getElementById('main-content');
            mainContent.setAttribute('tabindex', '-1');
            
            // Set up focus trapping for modals
            setupFocusTrapping();
            
            // Set up keyboard shortcuts
            setupKeyboardShortcuts();
            
            // Initialize mobile menu
            initMobileMenu();
            
            // Set up reduced motion support
            setupReducedMotion();
        }

        // Initialize mobile menu with ARIA
        function initMobileMenu() {
            const menuButton = document.querySelector('.menu-button');
            const navMenu = document.getElementById('nav-menu');
            
            if (menuButton && navMenu) {
                menuButton.addEventListener('click', function() {
                    const isExpanded = this.getAttribute('aria-expanded') === 'true';
                    this.setAttribute('aria-expanded', !isExpanded);
                    navMenu.hidden = isExpanded;
                    
                    announceToScreenReader(isExpanded ? 'Menu collapsed' : 'Menu expanded');
                });
                
                // Close menu when clicking outside
                document.addEventListener('click', function(event) {
                    if (!menuButton.contains(event.target) && !navMenu.contains(event.target)) {
                        menuButton.setAttribute('aria-expanded', 'false');
                        navMenu.hidden = true;
                    }
                });
            }
        }

        // Set up keyboard shortcuts
        function setupKeyboardShortcuts() {
            document.addEventListener('keydown', function(event) {
                // Skip link activation
                if (event.key === 's' && event.ctrlKey) {
                    document.querySelector('.skip-link').focus();
                    event.preventDefault();
                }
                
                // Open file dialog (Ctrl/Cmd + O)
                if ((event.ctrlKey || event.metaKey) && event.key === 'o') {
                    document.getElementById('uploadBtn').click();
                    event.preventDefault();
                }
                
                // Start conversion (Ctrl/Cmd + Enter)
                if ((event.ctrlKey || event.metaKey) && event.key === 'Enter') {
                    const convertBtn = document.getElementById('convertBtn');
                    if (convertBtn && !convertBtn.disabled) {
                        convertBtn.click();
                        event.preventDefault();
                    }
                }
                
                // Escape key closes modals/menus
                if (event.key === 'Escape') {
                    // Close mobile menu
                    const menuButton = document.querySelector('.menu-button');
                    if (menuButton && menuButton.getAttribute('aria-expanded') === 'true') {
                        menuButton.click();
                    }
                }
            });
        }

        // Set up focus trapping
        function setupFocusTrapping() {
            const modal = document.querySelector('.modal');
            if (modal) {
                const focusableElements = modal.querySelectorAll(
                    'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
                );
                
                const firstElement = focusableElements[0];
                const lastElement = focusableElements[focusableElements.length - 1];
                
                modal.addEventListener('keydown', function(event) {
                    if (event.key === 'Tab') {
                        if (event.shiftKey) {
                            if (document.activeElement === firstElement) {
                                lastElement.focus();
                                event.preventDefault();
                            }
                        } else {
                            if (document.activeElement === lastElement) {
                                firstElement.focus();
                                event.preventDefault();
                            }
                        }
                    }
                });
            }
        }

        // Set up reduced motion support
        function setupReducedMotion() {
            const reduceMotionQuery = window.matchMedia('(prefers-reduced-motion: reduce)');
            
            function updateMotionPreference(event) {
                if (event.matches) {
                    document.documentElement.style.setProperty('--transition-duration', '0ms');
                } else {
                    document.documentElement.style.setProperty('--transition-duration', '200ms');
                }
            }
            
            updateMotionPreference(reduceMotionQuery);
            reduceMotionQuery.addEventListener('change', updateMotionPreference);
        }

        // Initialize application
        function initApp() {
            // File upload handling
            const fileInput = document.getElementById('fileInput');
            const uploadBtn = document.getElementById('uploadBtn');
            const uploadArea = document.querySelector('.upload-area');
            
            // Click to upload
            uploadBtn.addEventListener('click', () => fileInput.click());
            
            // Drag and drop with ARIA
            uploadArea.addEventListener('dragover', function(event) {
                event.preventDefault();
                this.classList.add('drag-over');
                announceToScreenReader('Drop file here to upload');
            });
            
            uploadArea.addEventListener('dragleave', function() {
                this.classList.remove('drag-over');
            });
            
            uploadArea.addEventListener('drop', function(event) {
                event.preventDefault();
                this.classList.remove('drag-over');
                
                const files = event.dataTransfer.files;
                if (files.length > 0) {
                    handleFileUpload(files[0]);
                }
            });
            
            // File input change
            fileInput.addEventListener('change', function(event) {
                if (this.files.length > 0) {
                    handleFileUpload(this.files[0]);
                }
            });
            
            // Button event listeners
            document.getElementById('convertBtn').addEventListener('click', startConversion);
            document.getElementById('clearBtn').addEventListener('click', clearFile);
            document.getElementById('downloadBtn').addEventListener('click', downloadFile);
            document.getElementById('newConversionBtn').addEventListener('click', resetConverter);
            
            // Form submission
            document.getElementById('conversion-form').addEventListener('submit', function(event) {
                event.preventDefault();
                startConversion();
            });
        }

        // Handle file upload with accessibility
        function handleFileUpload(file) {
            // Validate file
            if (!file.name.toLowerCase().endsWith('.pdf')) {
                showAlert('Please upload only PDF files.', 'error');
                return;
            }
            
            if (file.size > 100 * 1024 * 1024) {
                showAlert('File size must be less than 100MB.', 'error');
                return;
            }
            
            // Announce to screen reader
            announceToScreenReader(`File ${file.name} selected for conversion`);
            
            // Show file section
            const fileSection = document.querySelector('.file-section');
            fileSection.hidden = false;
            fileSection.focus();
            
            // Update file info
            const fileInfo = document.querySelector('.file-info');
            fileInfo.innerHTML = `
                <div role="status" aria-live="polite">
                    <h4>Selected File</h4>
                    <dl>
                        <dt>Name:</dt>
                        <dd>${file.name}</dd>
                        <dt>Size:</dt>
                        <dd>${formatFileSize(file.size)}</dd>
                        <dt>Type:</dt>
                        <dd>PDF Document</dd>
                    </dl>
                </div>
            `;
            
            // Update result filename
            document.getElementById('result-filename').textContent = 
                file.name.replace(/\.pdf$/i, '.pptx');
        }

        // Start conversion process
        function startConversion() {
            const convertBtn = document.getElementById('convertBtn');
            const progressSection = document.querySelector('.progress-section');
            
            // Disable convert button
            convertBtn.disabled = true;
            convertBtn.setAttribute('aria-disabled', 'true');
            
            // Show progress section
            progressSection.hidden = false;
            progressSection.focus();
            
            // Announce start
            announceToScreenReader('Starting PDF to PowerPoint conversion');
            
            // Update progress
            let progress = 0;
            const progressBar = document.querySelector('.progress-bar');
            const progressPercent = document.getElementById('progress-percent');
            const progressText = document.getElementById('progress-text');
            
            const interval = setInterval(() => {
                progress += 5;
                
                // Update progress bar
                progressBar.style.width = `${progress}%`;
                progressBar.setAttribute('aria-valuenow', progress);
                progressPercent.textContent = `${progress}%`;
                
                // Update progress text
                if (progress < 25) {
                    progressText.textContent = 'Reading PDF file...';
                } else if (progress < 50) {
                    progressText.textContent = 'Extracting content...';
                } else if (progress < 75) {
                    progressText.textContent = 'Creating slides...';
                } else if (progress < 100) {
                    progressText.textContent = 'Finalizing presentation...';
                }
                
                if (progress >= 100) {
                    clearInterval(interval);
                    completeConversion();
                }
            }, 100);
        }

        // Complete conversion
        function completeConversion() {
            const resultSection = document.querySelector('.result-section');
            const progressSection = document.querySelector('.progress-section');
            
            // Hide progress section
            progressSection.hidden = true;
            
            // Show result section
            resultSection.hidden = false;
            resultSection.focus();
            
            // Update result details
            const fileSize = Math.floor(Math.random() * 5 + 1);
            const pages = Math.floor(Math.random() * 20 + 5);
            
            document.getElementById('result-size').textContent = `${fileSize.toFixed(1)} MB`;
            document.getElementById('result-pages').textContent = `${pages} pages`;
            document.getElementById('result-time').textContent = '2.3 seconds';
            
            // Enable convert button
            const convertBtn = document.getElementById('convertBtn');
            convertBtn.disabled = false;
            convertBtn.setAttribute('aria-disabled', 'false');
            
            // Announce completion
            announceToScreenReader('Conversion complete! Your PowerPoint file is ready to download.');
        }

        // Download file
        function downloadFile() {
            const filename = document.getElementById('result-filename').textContent;
            
            // Create download link
            const link = document.createElement('a');
            link.href = '#';
            link.download = filename;
            link.click();
            
            // Announce download
            announceToScreenReader(`Downloading ${filename}`);
            
            // Show download confirmation
            showAlert(`${filename} download started`, 'success');
        }

        // Clear file
        function clearFile() {
            const fileSection = document.querySelector('.file-section');
            const fileInput = document.getElementById('fileInput');
            
            // Hide file section
            fileSection.hidden = true;
            
            // Reset file input
            fileInput.value = '';
            
            // Focus on upload area
            document.querySelector('.upload-area').focus();
            
            // Announce clearing
            announceToScreenReader('File cleared. Ready for new upload.');
        }

        // Reset converter
        function resetConverter() {
            const resultSection = document.querySelector('.result-section');
            const fileSection = document.querySelector('.file-section');
            const fileInput = document.getElementById('fileInput');
            
            // Hide sections
            resultSection.hidden = true;
            fileSection.hidden = true;
            
            // Reset form
            fileInput.value = '';
            document.getElementById('conversion-form').reset();
            
            // Focus on upload area
            document.querySelector('.upload-area').focus();
            
            // Announce reset
            announceToScreenReader('Converter reset. Ready for new conversion.');
        }

        // Show alert with ARIA
        function showAlert(message, type = 'info') {
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type}`;
            alertDiv.setAttribute('role', 'alert');
            alertDiv.setAttribute('aria-live', 'assertive');
            alertDiv.textContent = message;
            
            // Add to page
            const container = document.querySelector('.container');
            container.insertBefore(alertDiv, container.firstChild);
            
            // Remove after delay
            setTimeout(() => {
                alertDiv.remove();
            }, 5000);
        }

        // Announce to screen reader
        function announceToScreenReader(message) {
            const liveRegion = document.getElementById('live-region');
            liveRegion.textContent = message;
            
            // Clear after a moment
            setTimeout(() => {
                liveRegion.textContent = '';
            }, 1000);
        }

        // Format file size
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
        }

        // Add additional accessibility features
        function enhanceAccessibility() {
            // Add aria-describedby to complex controls
            const qualitySelect = document.getElementById('quality');
            qualitySelect.setAttribute('aria-describedby', 'quality-help');
            
            // Create help text
            const qualityHelp = document.createElement('div');
            qualityHelp.id = 'quality-help';
            qualityHelp.className = 'sr-only';
            qualityHelp.textContent = 'Higher quality results in larger file sizes';
            qualitySelect.parentNode.appendChild(qualityHelp);
            
            // Add aria-labels to icons
            document.querySelectorAll('[class*="fa-"]').forEach(icon => {
                if (!icon.hasAttribute('aria-label') && !icon.closest('[aria-hidden="true"]')) {
                    const label = getIconLabel(icon.className);
                    if (label) {
                        icon.setAttribute('aria-label', label);
                    }
                }
            });
        }

        // Get label for Font Awesome icons
        function getIconLabel(className) {
            const iconMap = {
                'fa-upload': 'Upload',
                'fa-file-powerpoint': 'PowerPoint',
                'fa-download': 'Download',
                'fa-redo': 'Restart',
                'fa-trash': 'Delete',
                'fa-cog': 'Settings',
                'fa-image': 'Image',
                'fa-file-export': 'Export',
                'fa-universal-access': 'Accessibility',
                'fa-keyboard': 'Keyboard',
                'fa-eye': 'Visibility',
                'fa-bars': 'Menu'
            };
            
            for (const [iconClass, label] of Object.entries(iconMap)) {
                if (className.includes(iconClass)) {
                    return label;
                }
            }
            
            return null;
        }

        // Initialize on load
        initAccessibility();
        initApp();
        enhanceAccessibility();
    </script>

    <!-- Additional non-critical JavaScript -->
    <script>
        // Load non-critical features after page load
        window.addEventListener('load', function() {
            // Lazy load images
            const lazyImages = document.querySelectorAll('img[data-src]');
            if ('IntersectionObserver' in window) {
                const imageObserver = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const img = entry.target;
                            img.src = img.dataset.src;
                            img.removeAttribute('data-src');
                            imageObserver.unobserve(img);
                        }
                    });
                });
                
                lazyImages.forEach(img => imageObserver.observe(img));
            }
            
            // Load web fonts if needed
            if ('fonts' in document) {
                document.fonts.load('1rem "Inter"').catch(() => {});
            }
        });
    </script>

    <!-- Structured Data with accessibility info -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "PDF to PowerPoint Converter",
        "url": "https://convertwise.com/pdf-to-powerpoint",
        "accessibilityFeature": [
            "screenReaderOptimized",
            "keyboardNavigation",
            "highContrastDisplay",
            "largePrint",
            "alternativeText"
        ],
        "accessibilityHazard": "none",
        "accessibilityControl": [
            "fullKeyboardControl",
            "fullMouseControl",
            "fullTouchControl"
        ],
        "accessibilityAPI": "ARIA",
        "accessibilitySummary": "WCAG 2.1 AA compliant with full screen reader support",
        "mainEntity": {
            "@type": "SoftwareApplication",
            "name": "PDF to PowerPoint Converter",
            "applicationCategory": "UtilityApplication",
            "operatingSystem": "Any",
            "offers": {
                "@type": "Offer",
                "price": "0",
                "priceCurrency": "USD"
            }
        }
    }
    </script>
</body>
</html>
